[
  {
    "id": 1,
    "category": "Core",
    "description": "创建 installCommands.ts 模块 - 参考 installSkills.ts 实现命令安装逻辑，包括 getCommandsSourceDir、getCommandsList、copyCommandDir、installToOpenCodeCommands、installToQwenCodeCommands、installCommands 等函数",
    "source": ".sisyphus/plans/add-commands-to-setup.md",
    "priority": "p0",
    "steps": [
      "1: 创建 src/utils/installCommands.ts 文件",
      "2: 实现 getCommandsSourceDir() 函数 - 返回 src/templates/commands/",
      "3: 实现 getCommandsList() 函数 - 获取 commands 目录列表",
      "4: 实现 copyCommandDir() 函数 - 复制单个 command 目录",
      "5: 实现 installToOpenCodeCommands() - 安装到 .opencode/commands/",
      "6: 实现 installToQwenCodeCommands() - 安装到 .qwen/commands/",
      "7: 实现 installCommands(targets) 分发函数",
      "8: 添加错误处理 - 权限检查、路径不存在处理"
    ],
    "passes": true
  },
  {
    "id": 2,
    "category": "Core",
    "description": "修改 setup.ts 增加 command 选项 - 在文件选择列表增加 Commands 选项，并在 AI 助手选择后增加 command 安装步骤",
    "source": ".sisyphus/plans/add-commands-to-setup.md",
    "priority": "p0",
    "steps": [
      "1: 修改 src/commands/setup.ts - 在文件选择列表增加 'Commands' 选项",
      "2: 导入 installCommands 函数和 CommandInstallationError",
      "3: 在 AI 助手选择后增加 command 安装步骤（类似 skill 安装）",
      "4: 更新提示文本 - 'Installing commands to AI assistants...'",
      "5: 实现成功/失败信息显示逻辑",
      "6: 测试覆盖已有 command 时的覆盖逻辑"
    ],
    "passes": true
  },
  {
    "id": 3,
    "category": "Test",
    "description": "测试 command 安装功能 - 运行完整测试验证 OpenCode 和 Qwen 两种情况的 command 安装功能",
    "source": ".sisyphus/plans/add-commands-to-setup.md",
    "priority": "p1",
    "steps": [
      "1: 构建项目 - npm run build",
      "2: 创建临时测试目录",
      "3: 运行 setup 命令并选择 OpenCode + Commands",
      "4: 验证 .opencode/commands/agent-harness-init.md 存在",
      "5: 清理测试文件",
      "6: 运行 setup 命令并选择 Qwen + Commands",
      "7: 验证 .qwen/commands/agent-harness-init.md 存在",
      "8: 清理测试文件",
      "9: 验证与现有 skill 功能共存无冲突"
    ],
    "passes": true
  },
  {
    "id": 4,
    "category": "Refactor",
    "description": "修改 setup.ts - 默认创建 AGENTS.md，移除询问提示",
    "source": ".agent-harness/plans/modify-setup-default-agents.md",
    "priority": "p0",
    "steps": [
      "1: 删除第 28-34 行 - 移除询问是否创建 AGENTS.md 的代码块",
      "2: 修改第 36-39 行 - 直接设置 selectedFiles = ['Commands', 'AGENTS.md']",
      "3: 简化第 60 行 - 移除 selectedFiles.includes('AGENTS.md') && 条件检查",
      "4: 验证 npm run build 编译通过",
      "5: 验证 npm test 测试通过"
    ],
    "passes": true
  },
  {
    "id": 5,
    "category": "Test",
    "description": "测试 setup 命令 - 验证无 AGENTS.md 时直接创建，不询问",
    "source": ".agent-harness/plans/modify-setup-default-agents.md",
    "priority": "p1",
    "steps": [
      "1: 创建临时测试目录且无 AGENTS.md 文件",
      "2: 运行 node dist/index.js setup 并选择 AI 助手",
      "3: 验证输出中无 Do you want to create AGENTS.md? 提示",
      "4: 验证 AGENTS.md 文件被创建",
      "5: 保存证据到 .agent-harness/evidence/task-1-no-prompt-create.md"
    ],
    "passes": true
  },
  {
    "id": 6,
    "category": "Test",
    "description": "测试 setup 命令 - 验证 AGENTS.md 存在时询问覆盖",
    "source": ".agent-harness/plans/modify-setup-default-agents.md",
    "priority": "p1",
    "steps": [
      "1: 创建临时测试目录并创建 AGENTS.md 文件",
      "2: 运行 node dist/index.js setup 并选择 AI 助手",
      "3: 验证输出中出现 The following files already exist: AGENTS.md. Do you want to overwrite them? 提示",
      "4: 输入 no 并验证文件未被覆盖",
      "5: 保存证据到 .agent-harness/evidence/task-1-overwrite-prompt.md"
    ],
    "passes": true
  }
]
